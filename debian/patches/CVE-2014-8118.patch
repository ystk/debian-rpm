Description: Limit the length of the file name to a reasonable value
 It was found that RPM could encounter an integer overflow, leading to
 a stack-based overflow, while parsing a crafted CPIO header in the
 payload section of an RPM file.  This could allow an attacker to
 modify signed RPM files in such a way that they would execute code
 chosen by the attacker during package installation.
Origin: backport, https://bugzilla.redhat.com/attachment.cgi?id=962159&action=diff
Bug: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-8118
Last-Update: 2014-12-14

Index: rpm-4.11.3/lib/cpio.c
===================================================================
--- rpm-4.11.3.orig/lib/cpio.c	2013-11-22 02:31:31.000000000 -0800
+++ rpm-4.11.3/lib/cpio.c	2014-12-14 17:44:58.572662964 -0800
@@ -296,6 +296,9 @@
     st->st_rdev = makedev(major, minor);
 
     GET_NUM_FIELD(hdr.namesize, nameSize);
+    if (nameSize <= 0 || nameSize > 4096) {
+        return CPIOERR_BAD_HEADER;
+    }
 
     *path = xmalloc(nameSize + 1);
     read = Fread(*path, nameSize, 1, cpio->fd);
