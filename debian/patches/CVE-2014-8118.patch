diff --git a/lib/cpio.c b/lib/cpio.c
index 9003494..a72f6d1 100644
--- a/lib/cpio.c
+++ b/lib/cpio.c
@@ -153,6 +153,9 @@ int cpioHeaderRead(FSM_t fsm, struct stat * st)
     GET_NUM_FIELD(hdr.namesize, nameSize);
     if (nameSize >= fsm->wrsize)
 	return CPIOERR_BAD_HEADER;
+    if (nameSize <= 0 || nameSize > 4096) {
+       return CPIOERR_BAD_HEADER;
+    }
 
     {	char * t = xmalloc(nameSize + 1);
 	fsm->wrlen = nameSize;
